@using AStwoD.Infrastructure.HtmlHelpers
@using StackExchange.Profiling;
<html>
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/bootstrap.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/css/jquery.fancybox.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.9.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.24.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/insertMeta.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/knockout-2.2.1.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/ourLibs/jquery-1.8.1.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive-ajax.js")" type="text/javascript"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/tinymce/tinymce.min.js")"></script>
</head>
<body>

    <script type="text/javascript">
        tinymce.init({
            selector: ".tiny",
            plugins: [
                "advlist autolink lists link image charmap print preview anchor",
                "searchreplace visualblocks code fullscreen",
                "insertdatetime media table contextmenu paste"
            ],
            toolbar: "insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"
        });
    </script>

    <div id="wrapper">
        <div class="navbar navbar-inverse" style="position: static;">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-inverse-collapse">
                        <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href=".">AStwoD</a>
                    <div class="nav-collapse collapse navbar-inverse-collapse">
                        <ul class="nav">

                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Страницы<b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="@(Context.User.IsInRole("Admin") ? Url.Action("Pages") : Url.Action("PagesForSEO"))">Все страницы</a></li>
                                    @if (Context.User.IsInRole("Admin"))
                                    {
                                        <li><a href="@Url.Action("Create")">Добавить страницу</a></li>
                                    }
                                </ul>
                            </li>

                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Шаблоны
                                                     <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="@Url.Action("Templates")">Список шаблонов</a></li>
                                    <li><a href="@Url.Action("CreateTemplate")">Добавить шаблон</a></li>
                                    <li class="divider"></li>
                                    <li><a href="@Url.Action("Components")">Все компоненты</a></li>
                                    <li><a href="@Url.Action("CreateComponent")">Добавить компонент</a></li>
                                </ul>
                            </li>
                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Менеджер файлов<b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="@Url.Action("Pictures")">Изображения</a></li>
                                    <li><a href="@Url.Action("StyleSheets")">Стили CSS</a></li>
                                    <li><a href="@Url.Action("JScripts")">Файлы JavaScript</a></li>
                                </ul>
                            </li>

                            @*
                            @if(Context.User.IsInRole("Admin")){
                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Меню
                                <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="#">Просмотр меню</a></li>
                                    <li><a href="#">Создать меню</a></li>
                                </ul>
                            </li>
                            }*@
                        </ul>

                        <form class="navbar-search pull-left">
                            <input id="search" type="text" class="search-query" placeholder="Search">
                            <div class="resSearch" id="resSearch">
                            </div>
                        </form>
                        <script type="text/javascript">
                            $(function () {
                                $("#search").keyup(function () {
                                    $("#resSearch").empty();
                                    var title = $("#search").val();
                                    $.ajax({
                                        type: "POST",
                                        url: "@Url.Action("Index")",
                                        data: { "Title": title },
                                        cache: false,
                                        success: function (response) {
                                            console.log(typeof (response));
                                            if (typeof (response) === 'object') {
                                                for (var i in response) {
                                                    $("#resSearch").prepend("<a href=/" + response[i].LabelForURL + "><li>" + response[i].Title + "</li></a>");
                                                }
                                            }
                                        }
                                    });
                                    return false;
                                });
                            });
                        </script>
                        <ul class="nav pull-right">
                            <li><a href="@Url.Action("LogOf", "Account")">Выйти</a></li>
                            <li><span class="label label-small label-info">
                                <p>@(Context.User.IsInRole("Admin") ? "Administrator" : "SEO")</p>
                                Control Panel</span></li>
                        </ul>
                    </div>
                    <!-- /.nav-collapse -->
                </div>
            </div>
            <!-- /navbar-inner -->
        </div>
        <div id="left-menu">
            <ul class="nav nav-list">
                <li class="nav-header">Управление сайтом</li>
                <li><a href=".">Главная</a></li>
                <li><a href="@(Context.User.IsInRole("Admin") ? Url.Action("Pages") : Url.Action("PagesForSEO"))">Страницы</a></li>
                @*@if(Context.User.IsInRole("Admin")){<li><a href="#">Меню</a></li>}*@
                <li class="divider"></li>
                <li><a href="@Url.Action("LogOf", "Account")">Выход</a></li>
            </ul>
        </div>
        <div id="content">
            @RenderBody()

        </div>
    </div>
    <script src="@Url.Content("~/Scripts/bootstrap.js")" type="text/javascript"></script>
    @MiniProfiler.RenderIncludes()
    <script>
        $(function () {
            $('body *').tooltip();
        });
    </script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/ourLibs/insertMeta.js")"></script>
</body>
</html>
